Warning on use of the timeseries module: If the inherent timescales of the system are long compared to those being analyzed, this statistical inefficiency may be an underestimate.  The estimate presumes the use of many statistically independent samples.  Tests should be performed to assess whether this condition is satisfied.   Be cautious in the interpretation of the data.

****** PyMBAR will use 64-bit JAX! *******
* JAX is currently set to 32-bit bitsize *
* which is its default.                  *
*                                        *
* PyMBAR requires 64-bit mode and WILL   *
* enable JAX's 64-bit mode when called.  *
*                                        *
* This MAY cause problems with other     *
* Uses of JAX in the same code.          *
******************************************

2024-07-16 09:47:52.229 | INFO     | alchemlyb.workflows.base:__init__:50 - Alchemlyb Version: f2.3.0
2024-07-16 09:47:52.230 | INFO     | alchemlyb.workflows.base:__init__:51 - Set Temperature to 300 K.
2024-07-16 09:47:52.230 | INFO     | alchemlyb.workflows.base:__init__:53 - Set Software to GROMACS.
2024-07-16 09:47:52.230 | INFO     | alchemlyb.workflows.abfe:__init__:83 - Initialise Alchemlyb ABFE Workflow
2024-07-16 09:47:52.230 | INFO     | alchemlyb.workflows.abfe:update_units:307 - Set unit to kcal/mol.
2024-07-16 09:47:52.230 | INFO     | alchemlyb.workflows.abfe:__init__:85 - Finding files with prefix: dhdl, suffix: xvg under directory ./ produced by GROMACS
2024-07-16 09:47:52.231 | INFO     | alchemlyb.workflows.abfe:__init__:102 - Found 1 xvg files.
2024-07-16 09:47:52.231 | INFO     | alchemlyb.workflows.abfe:__init__:103 - Unsorted file list: 
 dhdl.xvg
2024-07-16 09:47:52.231 | INFO     | alchemlyb.workflows.abfe:__init__:106 - Using GROMACS parser to read the data.
2024-07-16 09:47:52.435 | INFO     | alchemlyb.workflows.abfe:read:145 - Reading 24135 lines of u_nk from dhdl.xvg
2024-07-16 09:47:52.555 | INFO     | alchemlyb.workflows.abfe:read:155 - Reading 24135 lines of dhdl from dhdl.xvg
2024-07-16 09:47:52.555 | INFO     | alchemlyb.workflows.abfe:read:164 - Sort files according to the u_nk.
2024-07-16 09:47:52.557 | INFO     | alchemlyb.workflows.abfe:read:184 - Sorted file list: 
dhdl.xvg
2024-07-16 09:47:52.558 | INFO     | alchemlyb.workflows.abfe:preprocess:333 - Start preprocessing with skiptime of 100 uncorrelation method of dhdl and threshold of 50
2024-07-16 09:47:52.558 | INFO     | alchemlyb.workflows.abfe:preprocess:339 - Processing the u_nk data set with skiptime of 100.
2024-07-16 09:47:52.710 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:608 - Running equilibration detection.
2024-07-16 09:48:33.819 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:610 - Start index: 0.
2024-07-16 09:48:33.820 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:611 - Statistical inefficiency: 206.39.
2024-07-16 09:48:33.822 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:617 - Number of uncorrelated samples: 115.
2024-07-16 09:48:33.827 | INFO     | alchemlyb.workflows.abfe:preprocess:357 - Take 115 uncorrelated u_nk for state 0.
2024-07-16 09:48:33.846 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:608 - Running equilibration detection.
2024-07-16 09:49:10.206 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:610 - Start index: 0.
2024-07-16 09:49:10.206 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:611 - Statistical inefficiency: 114.71.
2024-07-16 09:49:10.209 | DEBUG    | alchemlyb.preprocessing.subsampling:equilibrium_detection:617 - Number of uncorrelated samples: 207.
2024-07-16 09:49:10.210 | INFO     | alchemlyb.workflows.abfe:preprocess:379 - Take 207 uncorrelated dHdl for state 0.
2024-07-16 09:49:10.211 | INFO     | alchemlyb.workflows.abfe:estimate:421 - Start running estimator: MBAR,BAR,TI.
2024-07-16 09:49:10.212 | INFO     | alchemlyb.workflows.abfe:estimate:430 - A total 207 lines of dHdl is used.
2024-07-16 09:49:10.212 | INFO     | alchemlyb.workflows.abfe:estimate:438 - A total 115 lines of u_nk is used.
2024-07-16 09:49:10.213 | INFO     | alchemlyb.workflows.abfe:estimate:442 - Run MBAR estimator.
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/mbar_.py:125: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  (len(groups.get_group(i)) if i in groups.groups else 0)
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:97: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  (len(groups.get_group(i)) if i in groups.groups else 0)
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:106: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  uk = groups.get_group(self._states_[k])
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:111: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  uk1 = groups.get_group(self._states_[k + 1])

******* JAX 64-bit mode is now on! *******
*     JAX is now set to 64-bit mode!     *
*   This MAY cause problems with other   *
*      uses of JAX in the same code.     *
******************************************

2024-07-16 09:49:14.680 | INFO     | alchemlyb.workflows.abfe:estimate:449 - Run BAR estimator.
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:97: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  (len(groups.get_group(i)) if i in groups.groups else 0)
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:106: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  uk = groups.get_group(self._states_[k])
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:111: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  uk1 = groups.get_group(self._states_[k + 1])
2024-07-16 09:49:14.747 | INFO     | alchemlyb.workflows.abfe:estimate:452 - Run TI estimator.
2024-07-16 09:49:14.777 | INFO     | alchemlyb.workflows.abfe:generate_result:505 - Summarise the estimate into a dataframe.
2024-07-16 09:49:14.778 | INFO     | alchemlyb.workflows.abfe:generate_result:507 - Generate the row names.
2024-07-16 09:49:14.783 | INFO     | alchemlyb.workflows.abfe:generate_result:518 - use the stage name from u_nk
2024-07-16 09:49:14.783 | INFO     | alchemlyb.workflows.abfe:generate_result:532 - Read the results from estimator MBAR
2024-07-16 09:49:14.784 | INFO     | alchemlyb.workflows.abfe:generate_result:549 - Generate the staged result from estimator MBAR
2024-07-16 09:49:14.784 | INFO     | alchemlyb.workflows.abfe:generate_result:568 - Stage vdw-lambda is from state 0 to state 7.
2024-07-16 09:49:14.785 | INFO     | alchemlyb.workflows.abfe:generate_result:532 - Read the results from estimator BAR
2024-07-16 09:49:14.786 | INFO     | alchemlyb.workflows.abfe:generate_result:549 - Generate the staged result from estimator BAR
2024-07-16 09:49:14.786 | INFO     | alchemlyb.workflows.abfe:generate_result:568 - Stage vdw-lambda is from state 0 to state 7.
2024-07-16 09:49:14.787 | INFO     | alchemlyb.workflows.abfe:generate_result:532 - Read the results from estimator TI
2024-07-16 09:49:14.788 | INFO     | alchemlyb.workflows.abfe:generate_result:549 - Generate the staged result from estimator TI
2024-07-16 09:49:14.788 | INFO     | alchemlyb.workflows.abfe:generate_result:568 - Stage vdw-lambda is from state 0 to state 7.
2024-07-16 09:49:14.804 | INFO     | alchemlyb.workflows.abfe:generate_result:610 - Write results:
                   MBAR  MBAR_Error       BAR  BAR_Error        TI  TI_Error
States 0 -- 1  2.262907    0.133659  2.292751   0.130998  2.828644  0.137886
       1 -- 2  3.286187    0.275616  3.309617   0.254893  3.023968  0.193595
       2 -- 3  1.288859    0.272267  1.312595   0.263797  1.468725  0.147492
       3 -- 4  0.119441    0.237274  0.145755   0.235792  0.186892  0.178900
       4 -- 5 -0.686846    0.211541 -0.685011   0.219987 -0.844983  0.160905
       5 -- 6 -2.195601    0.242982 -2.191422   0.243803 -1.822391  0.161330
       6 -- 7 -1.367184    0.146457 -1.374078   0.146499 -1.453145  0.113139
Stages vdw     2.707762    0.754994  2.810206   0.370517  3.387708  0.575506
       TOTAL   2.707762    0.754994  2.810206   0.580184  3.387708  0.575506
2024-07-16 09:49:14.805 | INFO     | alchemlyb.workflows.abfe:plot_overlap_matrix:630 - Plot overlap matrix.
2024-07-16 09:49:17.265 | INFO     | alchemlyb.workflows.abfe:plot_overlap_matrix:634 - Plot overlap matrix to ./ under O_MBAR.pdf.
2024-07-16 09:49:17.317 | INFO     | alchemlyb.workflows.abfe:plot_ti_dhdl:661 - Plot TI dHdl.
2024-07-16 09:49:17.716 | INFO     | alchemlyb.workflows.abfe:plot_ti_dhdl:671 - Plot TI dHdl to dhdl_TI.pdf under ./.
2024-07-16 09:49:17.730 | INFO     | alchemlyb.workflows.abfe:plot_dF_state:705 - Plot dF states.
2024-07-16 09:49:18.241 | INFO     | alchemlyb.workflows.abfe:plot_dF_state:715 - Plot dF state to dF_state.pdf under ./.
2024-07-16 09:49:18.262 | INFO     | alchemlyb.workflows.abfe:plot_dF_state:705 - Plot dF states.
2024-07-16 09:49:18.688 | INFO     | alchemlyb.workflows.abfe:plot_dF_state:715 - Plot dF state to dF_state_long.pdf under ./.
2024-07-16 09:49:18.715 | INFO     | alchemlyb.workflows.abfe:check_convergence:752 - Start convergence analysis.
2024-07-16 09:49:18.716 | INFO     | alchemlyb.workflows.abfe:check_convergence:753 - Checking data availability.
2024-07-16 09:49:18.716 | INFO     | alchemlyb.workflows.abfe:check_convergence:758 - Subsampled u_nk is available.
2024-07-16 09:49:18.716 | INFO     | alchemlyb.convergence.convergence:forward_backward_convergence:78 - Start convergence analysis.
2024-07-16 09:49:18.716 | INFO     | alchemlyb.convergence.convergence:forward_backward_convergence:79 - Check data availability.
2024-07-16 09:49:18.716 | INFO     | alchemlyb.convergence.convergence:forward_backward_convergence:96 - Use MBAR estimator for convergence analysis.
2024-07-16 09:49:18.716 | INFO     | alchemlyb.convergence.convergence:forward_backward_convergence:98 - Begin forward analysis
2024-07-16 09:49:18.716 | INFO     | alchemlyb.convergence.convergence:forward_backward_convergence:102 - Forward analysis: 10.00%
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/mbar_.py:125: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  (len(groups.get_group(i)) if i in groups.groups else 0)
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:97: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  (len(groups.get_group(i)) if i in groups.groups else 0)
/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py:106: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  uk = groups.get_group(self._states_[k])
Traceback (most recent call last):
  File "/home/lindseywhitmore/projects/lennard-jones-miniproject/anthracene/switch_poential-switch/prod/try2_mpi/mbar/analysis.py", line 13, in <module>
    workflow.run(skiptime=100, uncorr='dhdl', threshold=50,
  File "/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/workflows/abfe.py", line 294, in run
    ax = self.check_convergence(forwrev, estimator="MBAR", dF_t="dF_t.pdf")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/workflows/abfe.py", line 774, in check_convergence
    convergence = forward_backward_convergence(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/convergence/convergence.py", line 106, in forward_backward_convergence
    mean, error = _forward_backward_convergence_estimate(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/convergence/convergence.py", line 168, in _forward_backward_convergence_estimate
    result = my_estimator.fit(sample)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/mbar_.py", line 136, in fit
    bar.fit(u_nk)
  File "/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/alchemlyb/estimators/bar_.py", line 106, in fit
    uk = groups.get_group(self._states_[k])
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindseywhitmore/anaconda3/envs/alchemlyb/lib/python3.12/site-packages/pandas/core/groupby/groupby.py", line 1114, in get_group
    raise KeyError(name)
KeyError: 0.0

